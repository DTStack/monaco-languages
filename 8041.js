(self.webpackChunkmonaco_languages=self.webpackChunkmonaco_languages||[]).push([[8041],{78041:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupLanguageMode:()=>l});var i=n(6610),s=n(5991),o=n(48785),r=function(){function e(t){var n=this;(0,i.Z)(this,e),this._defaults=void 0,this._idleCheckInterval=void 0,this._lastUsedTime=void 0,this._configChangeListener=void 0,this._worker=void 0,this._client=void 0,this._defaults=t,this._worker=null,this._idleCheckInterval=window.setInterval((function(){return n._checkIfIdle()}),3e4),this._lastUsedTime=0,this._configChangeListener=this._defaults.onDidChange((function(){return n._stopWorker()}))}return(0,s.Z)(e,[{key:"_stopWorker",value:function(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}},{key:"dispose",value:function(){clearInterval(this._idleCheckInterval),this._configChangeListener.dispose(),this._stopWorker()}},{key:"_checkIfIdle",value:function(){this._worker&&Date.now()-this._lastUsedTime>12e4&&this._stopWorker()}},{key:"_getClient",value:function(){return this._lastUsedTime=Date.now(),this._client||(this._worker=o.j6.createWebWorker({moduleId:this._defaults.languageId,label:this._defaults.languageId,createData:{languageSettings:this._defaults.diagnosticsOptions,languageId:this._defaults.languageId}}),this._client=this._worker.getProxy()),this._client}},{key:"getLanguageServiceWorker",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return this._getClient().then((function(t){e=t})).then((function(e){var n;return null===(n=t._worker)||void 0===n?void 0:n.withSyncedResources(i)})).then((function(t){return e}))}}]),e}(),a=n(79360),u=function(){function e(t,n,s){var r=this;(0,i.Z)(this,e),this._languageId=t,this._worker=n,this._disposables=[],this._listener=Object.create(null);var u=function(e){var t=e.getModeId();t===r._languageId&&(r._listener[e.uri.toString()]=e.onDidChangeContent((0,a.Ds)((function(){r._doValidate(e.uri,t)}),500)),r._doValidate(e.uri,t))},l=function(e){o.j6.setModelMarkers(e,r._languageId,[]);var t=e.uri.toString(),n=r._listener[t];n&&(n.dispose(),delete r._listener[t])};this._disposables.push(o.j6.onDidCreateModel(u)),this._disposables.push(o.j6.onWillDisposeModel(l)),this._disposables.push(o.j6.onDidChangeModelLanguage((function(e){l(e.model),u(e.model)}))),s.onDidChange((function(e){o.j6.getModels().forEach((function(e){e.getModeId()===r._languageId&&(l(e),u(e))}))})),this._disposables.push({dispose:function(){for(var e in r._listener)r._listener[e].dispose()}}),o.j6.getModels().forEach(u)}return(0,s.Z)(e,[{key:"dispose",value:function(){this._disposables.forEach((function(e){return e&&e.dispose()})),this._disposables=[]}},{key:"_doValidate",value:function(e,t){this._worker(e).then((function(t){return t.doValidation(e.toString())})).then((function(n){var i=n.map((function(e){return n="number"==typeof(t=e).code?String(t.code):t.code,{severity:(t.severity,o.ZL.Error),startLineNumber:t.startLine,startColumn:t.startCol,endLineNumber:t.endLine,endColumn:t.endCol,message:t.message,code:n,source:t.source};var t,n})),s=o.j6.getModel(e);s&&s.getModeId()===t&&o.j6.setModelMarkers(s,t,i)})).then(void 0,(function(e){console.error(e)}))}}]),e}();function l(e){var t=[],n=[],i=new r(e);t.push(i);var s,o;return s=e.languageId,o=e.modeConfiguration,h(n),o.diagnostics&&n.push(new u(s,(function(){return i.getLanguageServiceWorker.apply(i,arguments)}),e)),window.MonacoEnvironment={getWorkerUrl:function(e,t){switch(t){case"sparksql":return"./sparksql.worker.js";case"flinksql":return"./flinksql.worker.js";default:return"./editor.worker.js"}}},t.push(d(n)),d(t)}function d(e){return{dispose:function(){return h(e)}}}function h(e){for(;e.length;){var t;null===(t=e.pop())||void 0===t||t.dispose()}}}}]);